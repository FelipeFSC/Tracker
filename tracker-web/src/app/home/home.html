<ng-container *ngIf="isMobile; else desktopLayout">
	<app-principal [title]="'Meu Tracker'"></app-principal>
	<app-navigation></app-navigation>

	<div class="app-content">
		<div class="form-container">
			<form (ngSubmit)="enviarFormulario()">
				<h2>Tracker</h2>

				<div id="tasks-container">
					<div class="grouped-fields" *ngFor="let task of tasks; let i = index" #lastTask>
						<div class="form-row" *ngIf="!isOpen">
							<mat-form-field appearance="fill">
								<mat-label>Hora Início</mat-label>
								<input matInput type="time" [(ngModel)]="task.horaInicio" name="horaInicio-{{ i }}"
									required>
							</mat-form-field>

							<mat-form-field appearance="fill">
								<mat-label>Hora Fim</mat-label>
								<input matInput type="time" [(ngModel)]="task.horaFim" name="horaFim-{{ i }}" required>
							</mat-form-field>
						</div>
						<div class="form-row" *ngIf="!isOpen">
							<mat-form-field>
								<mat-label>Tipo de atividade</mat-label>
								<mat-select>
									<mat-option value="option">Tarefa</mat-option>
									<mat-option value="option">Reunião</mat-option>
									<mat-option value="option">Almoço</mat-option>
									<mat-option value="option">Férias</mat-option>
								</mat-select>
							</mat-form-field>
							<mat-form-field>
								<mat-label>Solicitante</mat-label>
								<mat-select>
									<mat-option value="option">Coca cola</mat-option>
									<mat-option value="option">Itau</mat-option>
									<mat-option value="option">Bradesco</mat-option>
									<mat-option value="option">Xuxa</mat-option>
								</mat-select>
							</mat-form-field>
						</div>
						<ng-container *ngIf="isOpen">
							<mat-form-field class="full-width">
								<mat-label>OS</mat-label>
								<input matInput>
							</mat-form-field>
							<mat-form-field class="full-width">
								<mat-label>Observações</mat-label>
								<textarea matInput rows="1" placeholder="" [(ngModel)]="task.descricao"
									name="descricao"></textarea>
							</mat-form-field>
						</ng-container>
						<div class="form-actions">
							<button mat-raised-button color="warn" type="button" class="buttom-radius action-buttom"
								(click)="removerTarefa(i)">
								Deletar
							</button>

							<ng-container *ngIf="!isOpen">
								<button mat-raised-button color="primary" type="button"
									class="buttom-radius action-buttom" (click)="onOpen()">
									Abrir
								</button>
							</ng-container>
							<ng-container *ngIf="isOpen">
								<button mat-raised-button type="button" class="buttom-radius action-buttom alert-button"
									(click)="onOpen()">
									Fechar
								</button>
							</ng-container>
						</div>
					</div>
				</div>


				<div class="actions">
					<button mat-raised-button color="accent" type="button" class="buttom-radius"
						(click)="adicionarTarefa()">
						+ Add tarefa
					</button>
				</div>

				<div class="actions">
					<button mat-raised-button class="full-width buttom-radius save-button" type="submit">Salvar</button>
				</div>

			</form>
		</div>
	</div>
</ng-container>

<ng-template #desktopLayout>
	<app-principal [title]="'Meu Tracker'"></app-principal>
	<app-navigation></app-navigation>

	<div class="app-content">

		<mat-card style="background-color: white !important; padding: 10px;">
			<div class="custom-table">

				<!-- Cabeçalho -->
				<div class="header-row">
					<div class="header-cell colaborador">Nome</div>
					<div class="header-cell data">Data</div>
					<div class="header-cell acoes">Opções</div>
				</div>

				<!-- Linhas -->
				<div class="data-row" *ngFor="let element of dataSource; let i = index"
					[ngClass]="i % 2 === 0 ? 'zebra-a' : 'zebra-b'">
					<!-- Linha principal -->
					<div class="cell colaborador">{{ element.colaborador }}</div>
					<div class="cell data">{{ element.data }}</div>
					<div class="cell acoes" style="text-align:center;">
						<button mat-icon-button (click)="toggleRow(element)">
							<mat-icon>
								{{ expandedElement === element ? 'expand_less' : 'expand_more' }}
							</mat-icon>
						</button>
					</div>

					<!-- Linha expandida -->
					<div class="expanded-row" *ngIf="expandedElement === element"
						style="padding: 16px; background: #f5f5f5; grid-column: 1 / -1;">
						<strong>Horário Início:</strong> {{ element.horario_inicio }} <br />
						<strong>Horário Término:</strong> {{ element.horario_termino }} <br />
						<strong>Tipo de Atividade:</strong> {{ element.tipo_atividade }} <br />
						<strong>Solicitante:</strong> {{ element.solicitante }} <br />
						<strong>OS:</strong> {{ element.os }} <br />
						<strong>Observações:</strong> {{ element.observacoes }} <br />
					</div>
				</div>
			</div>

		</mat-card>



	</div>
</ng-template>